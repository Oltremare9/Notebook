## Redis

### <u>Redis为什么快</u>

> 纯内存操作
>
> 单线程操作，减少了频繁的上下文切换
>
> 采用了非阻塞IO多路复用机制

### <u>什么是多路复用机制</u>

> 小名在 A 城开了一家快餐店店，负责同城快餐服务。小明因为资金限制，雇佣了一批配送员，然后小曲发现资金不够了，只够买一辆车送快递。
>
> 小明只雇佣一个配送员。当客户下单，小明按送达地点标注好，依次放在一个地方。最后，让配送员依次开着车去送，送好了就回来拿下一个。
>
> - 每个配送员→每个线程
> - 每个订单→每个 Socket(I/O 流)
> - 订单的送达地点→Socket 的不同状态
> - 客户送餐请求→来自客户端的请求
> - 明曲的经营方式→服务端运行的代码
> - 一辆车→CPU 的核数
>
> 只有单个线程(一个配送员)，通过跟踪每个 I/O 流的状态(每个配送员的送达地点)，来管理多个 I/O 流。
>
> Redis-client 在操作的时候，会产生具有不同事件类型的 Socket。在服务端，有一段 I/O 多路复用程序，将其置入**队列**之中。然后，**文件事件分派器**，**依次去队列中取**，转发到不同的事件处理器中。

### <u>Redis和Memcached的区别</u>

两者相同点 

> 两者都是基于内存的数据存储系统
>
> 本质上都是一个内存的key-value存储系统

两者的不同点

##### 1数据操作不同

> Memcached仅支持key-value的数据结构 不支持枚举，不支持持久化和复制
>
> Redis支持的数据结构更加丰富 支持list set zset hash string 并且通过了持久化和复制的功能

##### 2内存管理机制的不同

> Redis中，并不是所有的数据都一直存储在内存中，可以通过lru的机制，将一些很久没用的value交换到磁盘，并且在内存中进行删除
>
> Memcached默认使用Slab Allocation机制管理内存 思想是按照预先规定的大小，将分配的内存分割成特定长度的块以存储相应长度的key-value数据记录，以完全解决内存碎片问题。

##### 3性能不同

> Redis只能使用单核 平均每一个核上Redis在存储小数据时性能更高
>
> Memcached可以使用多核 存储100k以上的数据 性能更好

##### 4集群管理不同

> Memcached是全内存的数据缓冲系统，Redis虽然支持数据的持久化，但是全内存毕竟才是其高性能的本质。作为基于内存的存储系统来说，机器物理内存的大小就是系统能够容纳的最大数据量。如果需要处理的数据量超过了单台机器的物理内存大小，就需要构建分布式集群来扩展存储能力。
>
> Memcached本身不支持分布式，只能通过在客户端通过一致性hash的方式实现分布式存储。
>
> Redis则偏向于在服务端构建分布式存储。



### <u>为什么要使用Redis</u>

#### 性能问题

> 对于一些执行耗时很久，结果不频繁变动的SQL，适合将运行结果放入缓存，以减少对于MySQL的访问
>
> **例如 一些静态不会进行变更的一些数据 在秒杀时可以将其放在redis**

#### 并发问题

> 高并发的情况下，所有的请求直接访问数据库会极容易出现问题，所以需要用redis做一个缓冲操作
>
> **例如 redis实现的消息队列的形式**



### <u>Redis的问题以及解决方案</u>

#### *缓存和数据库双写一致性问题*

#### *缓存雪崩问题*

#### *缓存击穿问题*

#### *缓存的并发竞争问题*

#### 

### <u>分布式锁一定要用Redis吗 分布式锁的实现</u>

#### *数据库乐观锁*

#### *基于Redis的分布式锁*

#### *基于ZooKeeper的分布式锁*



### <u>Redis的淘汰策略</u>



### <u>Redis内部的数据结构(使用场景)以及底层实现</u>



[知乎解答]: https://zhuanlan.zhihu.com/p/50392209

